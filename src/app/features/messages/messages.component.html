<!-- =====================================================================
 * MESSAGES COMPONENT TEMPLATE
 * =====================================================================
 * Messages view: Outer mx-auto w-80% h-screen shadow-lg bg-background, sidebar bg-card p-3 border-r.
 * Updated: Consistent with profile - user-profile/chat-search/chat-list use bg-card rounded-lg shadow-custom border-border.
 * Main chat-messages bg-background, message-input bg-card p-4 border-t.
 * Header bg-card p-4 border-b shadow-sm.
 * Chat items hover:bg-muted/50 rounded-md (from study for interactive feedback).
 * No-chat text-muted-foreground.
 * References:
 * - Tailwind flex: https://tailwindcss.com/docs/flex (h-full min-h-0 for overflow).
 * - Angular ngIf/else: https://angular.dev/guide/control-flow (noChat template).
 * Iteration 1: Basic flex structure.
 * Iteration 2: Added classes for components (user-profile etc.).
 * Iteration 3: Responsive md/sm widths, overflow-hidden.
 * Best: Min-h-0 for flex-1 to prevent overflow issues (common in flex layouts).
 -->
<div class="mx-auto w-[80%] h-screen shadow-lg bg-background text-foreground md:w-[80%] sm:w-full">
  <div class="flex h-full">
    <!-- Sidebar -->
    <div class="w-64 p-3 flex flex-col bg-card border-r overflow-hidden md:w-64 sm:w-20 sm:overflow-x-hidden">
      <app-user-profile class="user-profile mb-4 p-4 bg-card rounded-lg shadow-custom border border-border"></app-user-profile>
      <app-chat-search class="chat-search mb-4" (searchChanged)="onSearch($event)"></app-chat-search>
      <app-chat-list class="chat-list flex-1 overflow-y-auto" [chats]="filteredChats()" (chatSelected)="selectConversation($event)" (chatDeleted)="deleteConversation($event)"></app-chat-list>
    </div>
 
    <!-- Main area -->
    <div class="flex-1 flex flex-col bg-background relative min-h-0">
      <app-chat-header class="chat-header bg-card p-4 border-b border-border flex items-center gap-3 shadow-sm" [recipient]="selectedConversation()?.otherUser?.name ?? 'Select a chat'" [avatar]="selectedConversation()?.otherUser?.avatar ?? ''"></app-chat-header>
      <ng-container *ngIf="selectedConversation(); else noChat">
        <app-chat-messages class="chat-messages flex-1 overflow-y-auto p-4 space-y-4 bg-background min-h-0 pb-16 md:pb-14 sm:pb-12" [messages]="messages()"></app-chat-messages>
      </ng-container>
      <ng-template #noChat>
        <div class="chat-messages flex-1 flex items-center justify-center text-muted-foreground min-h-0">
          <p>Select a chat to start messaging</p>
        </div>
      </ng-template>
      <app-message-input class="message-input sticky bottom-0 left-0 right-0 border-t border-border bg-card text-foreground z-10 p-4" (send)="send($event)" (sendWithFile)="sendWithFile($event)" [disabled]="!selectedConversation()"></app-message-input>
    </div>
  </div>
</div>